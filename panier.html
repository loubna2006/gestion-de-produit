<!DOCTYPE html> 
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panier - Loubna</title>
    <link rel="stylesheet" href="style.css">
    <style>
        table {
            width: 90%;
            max-width: 800px;
            margin: 30px auto;
            border-collapse: collapse;
            background-color: white;
        }
        th, td {
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f2f2f2;
        }
        #total-panier {
            font-weight: bold;
        }
        button {
            padding: 8px 15px;
            background-color: hsla(5, 100%, 69%, 0);
            color: rgb(242, 80, 11);
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }
        button:hover {
            background-color: #e0554f;
        }
        .supprimer-btn {
            background-color: #888;
        }
        .supprimer-btn:hover {
            background-color: #11468a;
        }
        h2 {
            text-align: center;
            margin-top: 20px;
        }
        /* Styles pour les commandes affichées */
        .commande {
            border: 1px solid #ccc;
            background-color: #f9f9f9;
            padding: 10px;
            margin: 15px auto;
            max-width: 800px;
        }
        .commande table {
            margin: 10px 0;
        }
    </style>
</head>
<body>

   <!-- Barre de navigation commune à toutes les pages -->
    <section id="header">
        <h1 class="logo">Loubna</h1>
        <ul id="navbar">
            <li><a href="index.html">Accueil</a></li>
            <li><a href="boutique.html">Boutique</a></li>
            <li><a href="panier.html">Panier</a></li>
             <li><a href="blog.html">blog</a></li>
             <li><a href="contact.html">contact</a></li>
            
        </ul>
    </section>

    <!-- Section Panier -->
    <section id="panier">
        <h2>Mon Panier</h2>
        <table>
            <thead>
                <tr>
                    <th>Produit</th>
                    <th>Prix</th>
                    <th>Quantité</th>
                    <th>Sous-total</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody id="panier-table">
                <!-- Les produits seront ajoutés ici via JavaScript -->
            </tbody>
        </table>
        <p style="text-align:center;">Total : <span id="total-panier">0 DH</span></p>
        <div style="text-align:center; margin-top:10px;">
            <button id="passer-commande" style="margin-right:10px; background-color:#11468a; color:white;">Passer mes commandes</button>
            <button id="voir-commandes" style="background-color:#11468a; color:white;">Voir mes commandes</button>
        </div>

        <!-- Conteneur pour afficher les commandes -->
        <div id="mes-commandes"></div>
    </section>

    <!-- Pied de page -->
    <footer>
        <p style="text-align:center;">&copy; 2025 Loubna Boutique - Tous droits réservés.</p>
    </footer>

    <!-- Script -->
    <script>
        // Récupérer le panier depuis LocalStorage
        let panier = JSON.parse(localStorage.getItem('panier')) || [];

        const panierTable = document.getElementById('panier-table');
        const totalPanier = document.getElementById('total-panier');
        const btnPasserCommande = document.getElementById('passer-commande');
        const btnVoirCommandes = document.getElementById('voir-commandes');
        const mesCommandes = document.getElementById('mes-commandes');

        // Fonction pour afficher le panier
        function afficherPanier() {
            panierTable.innerHTML = '';
            let total = 0;

            panier.forEach((produit, index) => {
                const sousTotal = produit.prix * produit.quantite;
                total += sousTotal;

                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${produit.nom}</td>
                    <td>${produit.prix} DH</td>
                    <td>${produit.quantite}</td>
                    <td>${sousTotal} DH</td>
                    <td><button class="supprimer-btn" data-index="${index}">Supprimer</button></td>
                `;
                panierTable.appendChild(tr);
            });

            totalPanier.textContent = total + ' DH';

            const btnSupprimer = document.querySelectorAll('.supprimer-btn');
            btnSupprimer.forEach(btn => {
                btn.addEventListener('click', () => {
                    const index = btn.getAttribute('data-index');
                    panier.splice(index, 1);
                    localStorage.setItem('panier', JSON.stringify(panier));
                    afficherPanier();
                });
            });
        }

        // Fonction pour passer la commande
        btnPasserCommande.addEventListener('click', () => {
            if (panier.length === 0) {
                alert("Votre panier est vide !");
                return;
            }

            // Ajouter la commande dans localStorage
            let commandes = JSON.parse(localStorage.getItem('commandes')) || [];
            const nouvelleCommande = {
                date: new Date().toLocaleString(),
                produits: panier,
                total: panier.reduce((acc, p) => acc + p.prix * p.quantite, 0)
            };
            commandes.push(nouvelleCommande);
            localStorage.setItem('commandes', JSON.stringify(commandes));

            alert("Commande passée avec succès !");
            panier = [];
            localStorage.removeItem('panier');
            afficherPanier();
        });

        // Fonction pour afficher les commandes en bas de la page
        btnVoirCommandes.addEventListener('click', () => {
            const commandes = JSON.parse(localStorage.getItem('commandes')) || [];
            mesCommandes.innerHTML = ''; // vider avant affichage

            if (commandes.length === 0) {
                mesCommandes.innerHTML = "<p style='text-align:center;'>Aucune commande passée.</p>";
                return;
            }

            commandes.forEach((commande, index) => {
                const div = document.createElement('div');
                div.className = "commande";

                let html = `<h3>Commande #${index + 1} - ${commande.date}</h3>`;
                html += `<table>
                            <thead>
                                <tr>
                                    <th>Produit</th>
                                    <th>Prix</th>
                                    <th>Quantité</th>
                                    <th>Sous-total</th>
                                </tr>
                            </thead>
                            <tbody>`;
                commande.produits.forEach(p => {
                    html += `<tr>
                                <td>${p.nom}</td>
                                <td>${p.prix} DH</td>
                                <td>${p.quantite}</td>
                                <td>${p.prix * p.quantite} DH</td>
                            </tr>`;
                });
                html += `</tbody></table>`;
                html += `<p style="text-align:right;font-weight:bold;">Total: ${commande.total} DH</p>`;

                div.innerHTML = html;
                mesCommandes.appendChild(div);
            });
        });

        // Afficher le panier au chargement
        afficherPanier();
    </script>

</body>
</html>
